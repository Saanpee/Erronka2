import{a as q}from"./chunk-ZCS2VR7V.js";import{a as H}from"./chunk-KFRKJJ5M.js";import{a as P}from"./chunk-3332PNLT.js";import{d as W,f as D,j as Y,k as V,l as j,n as K}from"./chunk-MJSMXMHF.js";import{a as G}from"./chunk-LH72YYA6.js";import"./chunk-PNKEXE34.js";import{f as U}from"./chunk-MJJXFY2L.js";import{Gb as w,Hb as O,Ib as Z,La as h,Lb as F,Mb as R,Na as m,Qa as i,Ra as a,Sa as f,Va as y,Vb as z,Wa as v,Wb as N,Xa as x,Z as B,bb as r,cb as p,db as g,eb as L,fb as b,ga as S,gb as I,ha as E,hb as k,jb as M,lb as T,mb as d,nb as o,ob as A,xa as t,ya as C}from"./chunk-6OJ5OLV5.js";var J=n=>["/bilerak/editatu",n];function Q(n,u){n&1&&(i(0,"a",23),f(1,"i",24),r(2),d(3,"translate"),a()),n&2&&(t(2),g(" ",o(3,1,"BILERAK.ADD_NEW")," "))}function X(n,u){if(n&1&&(i(0,"option",25),r(1),a()),n&2){let e=u.$implicit;m("value",e),t(),g(" ",e," ")}}function $(n,u){if(n&1&&(i(0,"option",19),r(1),a()),n&2){let e=u.$implicit;m("ngValue",e.id),t(),g(" ",e.izena," ")}}function ee(n,u){n&1&&f(0,"app-loading-spinner")}function te(n,u){if(n&1&&(i(0,"p",42),r(1),a()),n&2){let e=x().$implicit;t(),g(" ",e.deskribapena," ")}}function ie(n,u){if(n&1){let e=y();i(0,"div",43)(1,"div",44)(2,"a",45),f(3,"i",46),r(4),d(5,"translate"),a(),i(6,"button",47),v("click",function(){S(e);let l=x().$implicit,_=x(2);return E(_.confirmDelete(l))}),f(7,"i",48),a()()()}if(n&2){let e=x().$implicit;t(2),m("routerLink",T(4,J,e.id)),t(2),g(" ",o(5,2,"COMMON.EDIT")," ")}}function ae(n,u){if(n&1&&(i(0,"div",29)(1,"div",30)(2,"div",31)(3,"span",32),r(4),d(5,"translate"),a(),i(6,"span",32),r(7),d(8,"translate"),a()(),i(9,"div",5)(10,"h5",33),r(11),a(),h(12,te,2,1,"p",34),i(13,"ul",35)(14,"li",36),f(15,"i",37),r(16),d(17,"date"),a(),i(18,"li",36),f(19,"i",38),r(20),a(),i(21,"li",36),f(22,"i",39),r(23),a(),i(24,"li"),f(25,"i",40),r(26),a()()(),h(27,ie,8,6,"div",41),a()()),n&2){let e=u.$implicit,s=x(2);t(3),m("ngClass",s.getMotaBadgeClass(e.mota)),t(),g(" ",o(5,12,"BILERA.TYPE_"+e.mota.toUpperCase())," "),t(2),m("ngClass",s.getStatusBadgeClass(e.egoera)),t(),g(" ",o(8,14,"BILERA.STATUS_"+e.egoera.toUpperCase())," "),t(4),p(e.izena),t(),m("ngIf",e.deskribapena),t(4),g(" ",A(17,16,e.data,"dd/MM/yyyy")," "),t(4),L(" ",e.hasieraOrdua," - ",e.amaieraOrdua," "),t(3),g(" ",e.ikastetxeaIzena," "),t(3),g(" ",e.antolatzaileIzena," "),t(),m("ngIf",s.authService.isAdmin())}}function ne(n,u){n&1&&(i(0,"div",49)(1,"div",50),f(2,"i",51),i(3,"p",52),r(4),d(5,"translate"),a()()()),n&2&&(t(4),p(o(5,1,"BILERAK.NO_MEETINGS")))}function re(n,u){if(n&1&&(i(0,"div",26),h(1,ae,28,19,"div",27)(2,ne,6,3,"div",28),a()),n&2){let e=x();t(),m("ngForOf",e.filteredBilerak),t(),m("ngIf",e.filteredBilerak.length===0)}}var xe=(()=>{class n{constructor(e,s,l){this.bileraService=e,this.ikastetxeaService=s,this.authService=l,this.bilerak=[],this.filteredBilerak=[],this.ikastetxeak=[],this.filteredIkastetxeak=[],this.udalerriak=[],this.filters={},this.selectedLurraldea="",this.selectedUdalerria="",this.isLoading=!0,this.bileraToDelete=null}ngOnInit(){this.loadData()}loadData(){this.isLoading=!0,this.ikastetxeaService.getAll().subscribe(e=>{this.ikastetxeak=e,this.filteredIkastetxeak=e}),this.bileraService.getAll().subscribe({next:e=>{this.bilerak=e,this.filteredBilerak=e,this.isLoading=!1},error:()=>{this.isLoading=!1}})}onLurraldeaChange(){this.selectedUdalerria="",this.selectedLurraldea?(this.filteredIkastetxeak=this.ikastetxeak.filter(e=>e.lurraldea===this.selectedLurraldea),this.ikastetxeaService.getUdalerriak(this.selectedLurraldea).subscribe(e=>this.udalerriak=e)):(this.filteredIkastetxeak=this.ikastetxeak,this.udalerriak=[]),this.filters.ikastetxeaId=void 0,this.onFilterChange()}onUdalerriChange(){this.selectedUdalerria?this.filteredIkastetxeak=this.ikastetxeak.filter(e=>e.udalerria.toLowerCase()===this.selectedUdalerria.toLowerCase()):this.selectedLurraldea?this.filteredIkastetxeak=this.ikastetxeak.filter(e=>e.lurraldea===this.selectedLurraldea):this.filteredIkastetxeak=this.ikastetxeak,this.filters.ikastetxeaId=void 0,this.onFilterChange()}onFilterChange(){this.bileraService.getFiltered(this.filters).subscribe(e=>{if(this.filteredBilerak=e,this.filters.ikastetxeaId&&(this.filteredBilerak=this.filteredBilerak.filter(s=>s.ikastetxeaId===this.filters.ikastetxeaId)),this.selectedUdalerria){let s=this.filteredIkastetxeak.map(l=>l.id);this.filteredBilerak=this.filteredBilerak.filter(l=>s.includes(l.ikastetxeaId))}})}getMotaBadgeClass(e){switch(e){case"hezkuntza_saila":return"bg-primary";case"pribatua":return"bg-warning text-dark";case"beste_publiko":return"bg-info";default:return"bg-secondary"}}getStatusBadgeClass(e){switch(e){case"programatua":return"bg-success";case"burutua":return"bg-secondary";case"bertan_behera":return"bg-danger";default:return"bg-secondary"}}confirmDelete(e){confirm("Ziur zaude bilera hau ezabatu nahi duzula?")&&this.bileraService.delete(e.id).subscribe(()=>{this.bilerak=this.bilerak.filter(s=>s.id!==e.id),this.onFilterChange()})}static{this.\u0275fac=function(s){return new(s||n)(C(H),C(q),C(P))}}static{this.\u0275cmp=B({type:n,selectors:[["app-bilera-zerrenda"]],standalone:!0,features:[M],decls:67,vars:52,consts:[[1,"bilerak-page","fade-in"],[1,"page-header","d-flex","justify-content-between","align-items-center","mb-4"],[1,"text-muted","mb-0"],["routerLink","/bilerak/berria","class","btn btn-primary",4,"ngIf"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-12","col-md-6","col-lg-3"],[1,"form-label"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","guztiak"],["value","hezkuntza_saila"],["value","pribatua"],["value","beste_publiko"],["value","araba"],["value","bizkaia"],["value","gipuzkoa"],[3,"value",4,"ngFor","ngForOf"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[4,"ngIf"],["class","row g-4",4,"ngIf"],["routerLink","/bilerak/berria",1,"btn","btn-primary"],[1,"bi","bi-calendar-plus","me-2"],[3,"value"],[1,"row","g-4"],["class","col-12 col-md-6 col-xl-4",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"col-12","col-md-6","col-xl-4"],[1,"card","h-100","bilera-card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"badge",3,"ngClass"],[1,"card-title"],["class","card-text text-muted small",4,"ngIf"],[1,"list-unstyled","mb-0"],[1,"mb-2"],[1,"bi","bi-calendar","me-2","text-primary"],[1,"bi","bi-clock","me-2","text-primary"],[1,"bi","bi-building","me-2","text-primary"],[1,"bi","bi-person","me-2","text-primary"],["class","card-footer bg-white",4,"ngIf"],[1,"card-text","text-muted","small"],[1,"card-footer","bg-white"],[1,"d-flex","justify-content-end","gap-2"],[1,"btn","btn-outline-primary","btn-sm",3,"routerLink"],[1,"bi","bi-pencil","me-1"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],[1,"col-12"],[1,"text-center","text-muted","py-5"],[1,"bi","bi-calendar-x","display-1"],[1,"mt-3"]],template:function(s,l){s&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),r(4),d(5,"translate"),a(),i(6,"p",2),r(7),d(8,"translate"),a()(),h(9,Q,4,3,"a",3),a(),i(10,"div",4)(11,"div",5)(12,"div",6)(13,"div",7)(14,"label",8),r(15),d(16,"translate"),a(),i(17,"select",9),k("ngModelChange",function(c){return I(l.filters.mota,c)||(l.filters.mota=c),c}),v("ngModelChange",function(){return l.onFilterChange()}),i(18,"option",10),r(19),d(20,"translate"),a(),i(21,"option",11),r(22),d(23,"translate"),a(),i(24,"option",12),r(25),d(26,"translate"),a(),i(27,"option",13),r(28),d(29,"translate"),a(),i(30,"option",14),r(31),d(32,"translate"),a()()(),i(33,"div",7)(34,"label",8),r(35),d(36,"translate"),a(),i(37,"select",9),k("ngModelChange",function(c){return I(l.selectedLurraldea,c)||(l.selectedLurraldea=c),c}),v("ngModelChange",function(){return l.onLurraldeaChange()}),i(38,"option",10),r(39),d(40,"translate"),a(),i(41,"option",15),r(42,"Araba"),a(),i(43,"option",16),r(44,"Bizkaia"),a(),i(45,"option",17),r(46,"Gipuzkoa"),a()()(),i(47,"div",7)(48,"label",8),r(49),d(50,"translate"),a(),i(51,"select",9),k("ngModelChange",function(c){return I(l.selectedUdalerria,c)||(l.selectedUdalerria=c),c}),v("ngModelChange",function(){return l.onUdalerriChange()}),i(52,"option",10),r(53),d(54,"translate"),a(),h(55,X,2,2,"option",18),a()(),i(56,"div",7)(57,"label",8),r(58),d(59,"translate"),a(),i(60,"select",9),k("ngModelChange",function(c){return I(l.filters.ikastetxeaId,c)||(l.filters.ikastetxeaId=c),c}),v("ngModelChange",function(){return l.onFilterChange()}),i(61,"option",19),r(62),d(63,"translate"),a(),h(64,$,2,2,"option",20),a()()()()(),h(65,ee,1,0,"app-loading-spinner",21)(66,re,3,2,"div",22),a()),s&2&&(t(4),p(o(5,24,"BILERAK.TITLE")),t(3),p(o(8,26,"BILERAK.SUBTITLE")),t(2),m("ngIf",l.authService.isAdmin()),t(6),p(o(16,28,"BILERA.TYPE")),t(2),b("ngModel",l.filters.mota),t(2),p(o(20,30,"COMMON.ALL")),t(3),p(o(23,32,"BILERA.TYPE_GUZTIAK")),t(3),p(o(26,34,"BILERA.TYPE_HEZKUNTZA")),t(3),p(o(29,36,"BILERA.TYPE_PRIBATUA")),t(3),p(o(32,38,"BILERA.TYPE_BESTE")),t(4),p(o(36,40,"BILERA.TERRITORY")),t(2),b("ngModel",l.selectedLurraldea),t(2),p(o(40,42,"COMMON.ALL")),t(10),p(o(50,44,"BILERA.MUNICIPALITY")),t(2),b("ngModel",l.selectedUdalerria),t(2),p(o(54,46,"COMMON.ALL")),t(2),m("ngForOf",l.udalerriak),t(3),p(o(59,48,"BILERA.SCHOOL")),t(2),b("ngModel",l.filters.ikastetxeaId),t(),m("ngValue",void 0),t(),p(o(63,50,"COMMON.ALL")),t(2),m("ngForOf",l.filteredIkastetxeak),t(),m("ngIf",l.isLoading),t(),m("ngIf",!l.isLoading))},dependencies:[R,w,O,Z,F,U,K,V,j,Y,W,D,N,z,G],styles:[".bilera-card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease}.bilera-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 .5rem 1rem #00000026}"]})}}return n})();export{xe as BileraZerrendaComponent};
