import{a as w,b as D,c as v,d as P,e as V,g as U,h as q,i as G,j as K,k as j,l as Z,m as W,o as H}from"./chunk-MJSMXMHF.js";import{a as Q}from"./chunk-LH72YYA6.js";import{a as $}from"./chunk-E6XGQANW.js";import"./chunk-PNKEXE34.js";import{c as M,e as B,f as R}from"./chunk-MJJXFY2L.js";import{Gb as T,Ib as N,La as u,Mb as y,Na as p,Pa as b,Qa as n,Ra as t,Sa as c,Va as C,Vb as k,Wa as x,Wb as O,Xa as h,Z as S,bb as o,cb as I,db as d,eb as z,ga as g,ha as _,jb as A,kb as F,mb as r,nb as l,ob as L,xa as i,ya as E}from"./chunk-6OJ5OLV5.js";var X=()=>({min:4});function Y(a,f){a&1&&c(0,"app-loading-spinner",9)}function ee(a,f){a&1&&(n(0,"div",44),o(1),r(2,"translate"),t()),a&2&&(i(),d(" ",l(2,1,"VALIDATION.REQUIRED")," "))}function ie(a,f){a&1&&(n(0,"div",44),o(1),r(2,"translate"),t()),a&2&&(i(),d(" ",l(2,1,"VALIDATION.REQUIRED")," "))}function te(a,f){a&1&&(n(0,"div",44),o(1),r(2,"translate"),t()),a&2&&(i(),d(" ",l(2,1,"VALIDATION.INVALID_EMAIL")," "))}function ae(a,f){a&1&&(n(0,"div",44),o(1),r(2,"translate"),t()),a&2&&(i(),d(" ",l(2,1,"VALIDATION.REQUIRED")," "))}function ne(a,f){a&1&&(n(0,"small",45),o(1),r(2,"translate"),t()),a&2&&(i(),d(" ",l(2,1,"USER.PASSWORD_HINT")," "))}function re(a,f){a&1&&(n(0,"div",46),o(1),r(2,"translate"),t()),a&2&&(i(),d(" ",L(2,1,"VALIDATION.MIN_LENGTH",F(4,X))," "))}function le(a,f){a&1&&(n(0,"div",36)(1,"div",47),c(2,"input",48),n(3,"label",49),o(4),r(5,"translate"),t()()()),a&2&&(i(4),d(" ",l(5,1,"USER.ACTIVE")," "))}function oe(a,f){a&1&&c(0,"span",50)}function de(a,f){if(a&1){let e=C();n(0,"div",10)(1,"div",11)(2,"form",12),x("ngSubmit",function(){g(e);let m=h();return _(m.onSubmit())}),n(3,"div",13)(4,"div",14)(5,"label",15),o(6),r(7,"translate"),t(),c(8,"input",16),u(9,ee,3,3,"div",17),t(),n(10,"div",14)(11,"label",18),o(12),r(13,"translate"),t(),c(14,"input",19),u(15,ie,3,3,"div",17),t(),n(16,"div",14)(17,"label",20),o(18),r(19,"translate"),t(),c(20,"input",21),u(21,te,3,3,"div",17),t(),n(22,"div",14)(23,"label",22),o(24),r(25,"translate"),t(),n(26,"select",23)(27,"option",24),o(28),r(29,"translate"),t(),n(30,"option",25),o(31),r(32,"translate"),t(),n(33,"option",26),o(34),r(35,"translate"),t()(),u(36,ae,3,3,"div",17),t(),n(37,"div",14)(38,"label",27),o(39),r(40,"translate"),t(),n(41,"div",28),c(42,"input",29),n(43,"button",30),x("click",function(){g(e);let m=h();return _(m.togglePassword())}),c(44,"i",31),t()(),u(45,ne,3,3,"small",32)(46,re,3,5,"div",33),t(),n(47,"div",14)(48,"label",34),o(49),r(50,"translate"),t(),c(51,"input",35),t(),n(52,"div",36)(53,"label",37),o(54),r(55,"translate"),t(),c(56,"textarea",38),t(),u(57,le,6,3,"div",39),t(),n(58,"div",40)(59,"a",41),o(60),r(61,"translate"),t(),n(62,"button",42),u(63,oe,1,0,"span",43),o(64),r(65,"translate"),r(66,"translate"),t()()()()()}if(a&2){let e=h();i(2),p("formGroup",e.userForm),i(4),d(" ",l(7,35,"USER.FIRST_NAME")," * "),i(2),b("is-invalid",e.isFieldInvalid("izena")),i(),p("ngIf",e.isFieldInvalid("izena")),i(3),d(" ",l(13,37,"USER.LAST_NAME")," * "),i(2),b("is-invalid",e.isFieldInvalid("abizena")),i(),p("ngIf",e.isFieldInvalid("abizena")),i(3),d(" ",l(19,39,"USER.EMAIL")," * "),i(2),b("is-invalid",e.isFieldInvalid("email")),i(),p("ngIf",e.isFieldInvalid("email")),i(3),d(" ",l(25,41,"USER.ROLE")," * "),i(2),b("is-invalid",e.isFieldInvalid("rola")),i(2),I(l(29,43,"COMMON.SELECT")),i(3),I(l(32,45,"ROLES.GOD")),i(3),I(l(35,47,"ROLES.ADMIN")),i(2),p("ngIf",e.isFieldInvalid("rola")),i(3),z(" ",l(40,49,"USER.PASSWORD")," ",e.isEditMode?"":"*"," "),i(3),b("is-invalid",e.isFieldInvalid("pasahitza")),p("type",e.showPassword?"text":"password"),i(2),p("ngClass",e.showPassword?"bi-eye-slash":"bi-eye"),i(),p("ngIf",e.isEditMode),i(),p("ngIf",e.isFieldInvalid("pasahitza")),i(3),d(" ",l(50,51,"USER.PHONE")," "),i(5),d(" ",l(55,53,"USER.ADDRESS")," "),i(3),p("ngIf",e.isEditMode),i(3),d(" ",l(61,55,"COMMON.CANCEL")," "),i(2),p("disabled",e.isSaving),i(),p("ngIf",e.isSaving),i(),d(" ",e.isSaving?l(65,57,"COMMON.SAVING"):l(66,59,"COMMON.SAVE")," ")}}var ge=(()=>{class a{constructor(e,s,m,J){this.fb=e,this.userService=s,this.router=m,this.route=J,this.isEditMode=!1,this.isLoading=!1,this.isSaving=!1,this.showPassword=!1,this.userId=null}ngOnInit(){this.initForm();let e=this.route.snapshot.paramMap.get("id");e&&(this.isEditMode=!0,this.userId=parseInt(e,10),this.loadUser())}initForm(){this.userForm=this.fb.group({izena:["",[v.required,v.minLength(2)]],abizena:["",[v.required,v.minLength(2)]],email:["",[v.required,v.email]],pasahitza:["",this.isEditMode?[]:[v.required,v.minLength(4)]],rola:["",v.required],telefonoa:[""],helbidea:[""],aktibo:[!0]})}loadUser(){this.userId&&(this.isLoading=!0,this.userService.getById(this.userId).subscribe({next:e=>{e&&this.userForm.patchValue({izena:e.izena,abizena:e.abizena,email:e.email,rola:e.rola,telefonoa:e.telefonoa||"",helbidea:e.helbidea||"",aktibo:e.aktibo}),this.isLoading=!1},error:()=>{this.isLoading=!1,this.router.navigate(["/erabiltzaileak"])}}))}isFieldInvalid(e){let s=this.userForm.get(e);return s?s.invalid&&(s.dirty||s.touched):!1}togglePassword(){this.showPassword=!this.showPassword}onSubmit(){if(this.userForm.invalid){Object.keys(this.userForm.controls).forEach(m=>{this.userForm.get(m)?.markAsTouched()});return}this.isSaving=!0;let e=this.userForm.value;this.isEditMode&&!e.pasahitza&&delete e.pasahitza,(this.isEditMode?this.userService.update(this.userId,e):this.userService.create(e)).subscribe({next:()=>{this.isSaving=!1,this.router.navigate(["/erabiltzaileak"])},error:()=>{this.isSaving=!1}})}static{this.\u0275fac=function(s){return new(s||a)(E(W),E($),E(B),E(M))}}static{this.\u0275cmp=S({type:a,selectors:[["app-erabiltzaile-form"]],standalone:!0,features:[A],decls:18,vars:15,consts:[[1,"erabiltzaile-form-page","fade-in"],[1,"page-header","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/erabiltzaileak"],[1,"breadcrumb-item","active"],["message","Kargatzen...",4,"ngIf"],["class","card",4,"ngIf"],["message","Kargatzen..."],[1,"card"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-12","col-md-6"],["for","izena",1,"form-label"],["type","text","id","izena","formControlName","izena",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","abizena",1,"form-label"],["type","text","id","abizena","formControlName","abizena",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],["for","rola",1,"form-label"],["id","rola","formControlName","rola",1,"form-select"],["value",""],["value","god"],["value","admin"],["for","pasahitza",1,"form-label"],[1,"input-group"],["id","pasahitza","formControlName","pasahitza",1,"form-control",3,"type"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi",3,"ngClass"],["class","text-muted",4,"ngIf"],["class","invalid-feedback d-block",4,"ngIf"],["for","telefonoa",1,"form-label"],["type","tel","id","telefonoa","formControlName","telefonoa",1,"form-control"],[1,"col-12"],["for","helbidea",1,"form-label"],["id","helbidea","formControlName","helbidea","rows","2",1,"form-control"],["class","col-12",4,"ngIf"],[1,"d-flex","justify-content-end","gap-2","mt-4"],["routerLink","/erabiltzaileak",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],[1,"invalid-feedback"],[1,"text-muted"],[1,"invalid-feedback","d-block"],[1,"form-check","form-switch"],["type","checkbox","id","aktibo","formControlName","aktibo",1,"form-check-input"],["for","aktibo",1,"form-check-label"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(s,m){s&1&&(n(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),o(6),r(7,"translate"),t()(),n(8,"li",6),o(9),r(10,"translate"),r(11,"translate"),t()()(),n(12,"h1"),o(13),r(14,"translate"),r(15,"translate"),t()(),u(16,Y,1,0,"app-loading-spinner",7)(17,de,67,61,"div",8),t()),s&2&&(i(6),I(l(7,5,"ERABILTZAILEAK.TITLE")),i(3),d(" ",m.isEditMode?l(10,7,"ERABILTZAILEAK.EDIT"):l(11,9,"ERABILTZAILEAK.NEW")," "),i(4),d(" ",m.isEditMode?l(14,11,"ERABILTZAILEAK.EDIT_TITLE"):l(15,13,"ERABILTZAILEAK.NEW_TITLE")," "),i(3),p("ngIf",m.isLoading),i(),p("ngIf",!m.isLoading))},dependencies:[y,T,N,H,U,j,Z,D,w,K,P,V,q,G,R,O,k,Q],styles:[".page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;margin-bottom:0}.breadcrumb[_ngcontent-%COMP%]{margin-bottom:.5rem}"]})}}return a})();export{ge as ErabiltzaileFormComponent};
