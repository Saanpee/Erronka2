import{a as Z}from"./chunk-3332PNLT.js";import{b as F,d as K,f as P,j as V,k as W,l as Q,n as j}from"./chunk-MJSMXMHF.js";import{a as G}from"./chunk-LH72YYA6.js";import{a as H}from"./chunk-E6XGQANW.js";import"./chunk-PNKEXE34.js";import{f as D}from"./chunk-MJJXFY2L.js";import{Gb as O,Hb as R,Ib as U,La as f,Mb as w,Na as m,Qa as n,Ra as i,Sa as c,Va as A,Vb as k,Wa as _,Wb as N,Xa as h,Z as y,bb as d,cb as p,db as b,eb as C,fb as x,ga as M,gb as I,ha as L,hb as S,jb as B,lb as z,mb as l,nb as o,ua as T,xa as t,ya as v}from"./chunk-6OJ5OLV5.js";var q=a=>["/erabiltzaileak/editatu",a];function J(a,u){a&1&&(n(0,"a",30),c(1,"i",31),d(2),l(3,"translate"),i()),a&2&&(t(2),b(" ",o(3,1,"ERABILTZAILEAK.ADD_NEW")," "))}function X(a,u){a&1&&c(0,"app-loading-spinner",32)}function Y(a,u){if(a&1){let e=A();n(0,"button",45),l(1,"translate"),_("click",function(){M(e);let s=h().$implicit,E=h(2);return L(E.confirmDelete(s))}),c(2,"i",46),i()}a&2&&m("title",o(1,1,"COMMON.DELETE"))}function $(a,u){if(a&1&&(n(0,"tr")(1,"td"),c(2,"img",39),i(),n(3,"td")(4,"strong"),d(5),i()(),n(6,"td"),d(7),i(),n(8,"td")(9,"span",40),d(10),l(11,"translate"),i()(),n(12,"td")(13,"span",40),d(14),l(15,"translate"),l(16,"translate"),i()(),n(17,"td",36)(18,"div",41)(19,"a",42),l(20,"translate"),c(21,"i",43),i(),f(22,Y,3,3,"button",44),i()()()),a&2){let e=u.$implicit,r=h(2);t(2),m("src",r.getUserAvatar(e),T)("alt",e.izena),t(3),C("",e.izena," ",e.abizena,""),t(2),p(e.email),t(2),m("ngClass",r.getRoleBadgeClass(e.rola)),t(),b(" ",o(11,12,"ROLES."+e.rola.toUpperCase())," "),t(3),m("ngClass",e.aktibo?"bg-success":"bg-secondary"),t(),b(" ",e.aktibo?o(15,14,"USER.ACTIVE"):o(16,16,"USER.INACTIVE")," "),t(5),m("routerLink",z(20,q,e.id))("title",o(20,18,"COMMON.EDIT")),t(3),m("ngIf",r.canDelete(e))}}function ee(a,u){a&1&&(n(0,"tr")(1,"td",47),c(2,"i",48),d(3),l(4,"translate"),i()()),a&2&&(t(3),b(" ",o(4,1,"ERABILTZAILEAK.NO_USERS")," "))}function te(a,u){if(a&1&&(n(0,"div",33)(1,"div",34)(2,"table",35)(3,"thead")(4,"tr")(5,"th"),d(6),l(7,"translate"),i(),n(8,"th"),d(9),l(10,"translate"),i(),n(11,"th"),d(12),l(13,"translate"),i(),n(14,"th"),d(15),l(16,"translate"),i(),n(17,"th"),d(18),l(19,"translate"),i(),n(20,"th",36),d(21),l(22,"translate"),i()()(),n(23,"tbody"),f(24,$,23,22,"tr",37)(25,ee,5,3,"tr",38),i()()()()),a&2){let e=h();t(6),p(o(7,8,"USER.PHOTO")),t(3),p(o(10,10,"USER.NAME")),t(3),p(o(13,12,"USER.EMAIL")),t(3),p(o(16,14,"USER.ROLE")),t(3),p(o(19,16,"USER.STATUS")),t(3),p(o(22,18,"COMMON.ACTIONS")),t(3),m("ngForOf",e.filteredUsers),t(),m("ngIf",e.filteredUsers.length===0)}}function ie(a,u){if(a&1&&(n(0,"p",49),d(1),i()),a&2){let e=h();t(),C(" ",e.userToDelete.izena," ",e.userToDelete.abizena," ")}}var ge=(()=>{class a{constructor(e,r){this.userService=e,this.authService=r,this.users=[],this.filteredUsers=[],this.searchQuery="",this.selectedRole="",this.isLoading=!0,this.userToDelete=null}ngOnInit(){this.loadUsers()}loadUsers(){this.isLoading=!0,this.userService.getAdministratzaileak().subscribe({next:e=>{this.users=e,this.filteredUsers=e,this.isLoading=!1},error:()=>{this.isLoading=!1}})}onSearch(){this.filterUsers()}onFilterChange(){this.filterUsers()}filterUsers(){let e=[...this.users];if(this.searchQuery.trim()){let r=this.searchQuery.toLowerCase();e=e.filter(s=>s.izena.toLowerCase().includes(r)||s.abizena.toLowerCase().includes(r)||s.email.toLowerCase().includes(r))}this.selectedRole&&(e=e.filter(r=>r.rola===this.selectedRole)),this.filteredUsers=e}getUserAvatar(e){return e.argazkia?`assets/images/${e.argazkia}`:"assets/images/default-avatar.png"}getRoleBadgeClass(e){switch(e){case"god":return"bg-danger";case"admin":return"bg-primary";default:return"bg-secondary"}}canDelete(e){return this.authService.getCurrentUser()?.id===e.id?!1:this.authService.isGod()}confirmDelete(e){this.userToDelete=e;let r=document.getElementById("deleteModal");r&&new window.bootstrap.Modal(r).show()}deleteUser(){this.userToDelete&&this.userService.delete(this.userToDelete.id).subscribe({next:()=>{this.users=this.users.filter(r=>r.id!==this.userToDelete.id),this.filterUsers(),this.userToDelete=null;let e=document.getElementById("deleteModal");e&&window.bootstrap.Modal.getInstance(e)?.hide()}})}static{this.\u0275fac=function(r){return new(r||a)(v(H),v(Z))}}static{this.\u0275cmp=y({type:a,selectors:[["app-erabiltzaile-zerrenda"]],standalone:!0,features:[B],decls:52,vars:36,consts:[[1,"erabiltzaileak-page","fade-in"],[1,"page-header","d-flex","justify-content-between","align-items-center","mb-4"],[1,"text-muted","mb-0"],["routerLink","/erabiltzaileak/berria","class","btn btn-primary",4,"ngIf"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-12","col-md-6","col-lg-4"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"col-12","col-md-6","col-lg-3"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","god"],["value","admin"],["message","Kargatzen...",4,"ngIf"],["class","card",4,"ngIf"],["id","deleteModal","tabindex","-1","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],["class","fw-bold",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-danger",3,"click"],["routerLink","/erabiltzaileak/berria",1,"btn","btn-primary"],[1,"bi","bi-person-plus","me-2"],["message","Kargatzen..."],[1,"card"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"text-end"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"user-avatar",3,"src","alt"],[1,"badge",3,"ngClass"],[1,"btn-group","btn-group-sm"],[1,"btn","btn-outline-primary",3,"routerLink","title"],[1,"bi","bi-pencil"],["type","button","class","btn btn-outline-danger",3,"title","click",4,"ngIf"],["type","button",1,"btn","btn-outline-danger",3,"click","title"],[1,"bi","bi-trash"],["colspan","6",1,"text-center","py-4","text-muted"],[1,"bi","bi-inbox","display-4","d-block","mb-2"],[1,"fw-bold"]],template:function(r,s){r&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),d(4),l(5,"translate"),i(),n(6,"p",2),d(7),l(8,"translate"),i()(),f(9,J,4,3,"a",3),i(),n(10,"div",4)(11,"div",5)(12,"div",6)(13,"div",7)(14,"div",8)(15,"span",9),c(16,"i",10),i(),n(17,"input",11),l(18,"translate"),S("ngModelChange",function(g){return I(s.searchQuery,g)||(s.searchQuery=g),g}),_("ngModelChange",function(){return s.onSearch()}),i()()(),n(19,"div",12)(20,"select",13),S("ngModelChange",function(g){return I(s.selectedRole,g)||(s.selectedRole=g),g}),_("ngModelChange",function(){return s.onFilterChange()}),n(21,"option",14),d(22),l(23,"translate"),i(),n(24,"option",15),d(25),l(26,"translate"),i(),n(27,"option",16),d(28),l(29,"translate"),i()()()()()(),f(30,X,1,0,"app-loading-spinner",17)(31,te,26,20,"div",18),n(32,"div",19)(33,"div",20)(34,"div",21)(35,"div",22)(36,"h5",23),d(37),l(38,"translate"),i(),c(39,"button",24),i(),n(40,"div",25)(41,"p"),d(42),l(43,"translate"),i(),f(44,ie,2,2,"p",26),i(),n(45,"div",27)(46,"button",28),d(47),l(48,"translate"),i(),n(49,"button",29),_("click",function(){return s.deleteUser()}),d(50),l(51,"translate"),i()()()()()()),r&2&&(t(4),p(o(5,16,"ERABILTZAILEAK.TITLE")),t(3),p(o(8,18,"ERABILTZAILEAK.SUBTITLE")),t(2),m("ngIf",s.authService.isGod()),t(8),x("ngModel",s.searchQuery),m("placeholder",o(18,20,"ERABILTZAILEAK.SEARCH_PLACEHOLDER")),t(3),x("ngModel",s.selectedRole),t(2),p(o(23,22,"ERABILTZAILEAK.ALL_ROLES")),t(3),p(o(26,24,"ROLES.GOD")),t(3),p(o(29,26,"ROLES.ADMIN")),t(2),m("ngIf",s.isLoading),t(),m("ngIf",!s.isLoading),t(6),p(o(38,28,"COMMON.CONFIRM_DELETE")),t(5),p(o(43,30,"ERABILTZAILEAK.DELETE_CONFIRM")),t(2),m("ngIf",s.userToDelete),t(3),b(" ",o(48,32,"COMMON.CANCEL")," "),t(3),b(" ",o(51,34,"COMMON.DELETE")," "))},dependencies:[w,O,R,U,D,j,W,Q,F,V,K,P,N,k,G],styles:[".user-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;margin-bottom:.25rem}"]})}}return a})();export{ge as ErabiltzaileZerrendaComponent};
